# E1.1 — Project Setup

## Описание

Инициализация проекта: создание структуры директорий, настройка зависимостей, конфигурации и базовых исключений.

---

## Tasks

### T1.1.1 — Create project structure

**Описание:** Создать структуру `backend/src/` согласно архитектуре проекта.

**Файлы:**
```
backend/
├── src/
│   ├── __init__.py
│   ├── core/
│   │   └── __init__.py
│   ├── db/
│   │   ├── __init__.py
│   │   ├── models/
│   │   │   └── __init__.py
│   │   └── repositories/
│   │       └── __init__.py
│   ├── services/
│   │   └── __init__.py
│   ├── bot/
│   │   └── __init__.py
│   └── api/
│       └── __init__.py
└── tests/
    └── __init__.py
```

**DoD:**
- [ ] Все директории созданы
- [ ] Все `__init__.py` файлы созданы

---

### T1.1.2 — Setup dependencies

**Описание:** Настроить `pyproject.toml` и `requirements.txt` с необходимыми зависимостями.

**Зависимости (production):**
- aiogram>=3.4.0
- fastapi>=0.109.0
- uvicorn>=0.27.0
- sqlalchemy>=2.0.0
- asyncpg>=0.29.0
- alembic>=1.13.0
- pydantic>=2.5.0
- pydantic-settings>=2.1.0
- python-dotenv>=1.0.0

**Зависимости (dev):**
- pytest>=8.0.0
- pytest-asyncio>=0.23.0
- mypy>=1.8.0
- ruff>=0.2.0
- pre-commit>=3.6.0

**DoD:**
- [ ] `pyproject.toml` создан с metadata и dependencies
- [ ] `requirements.txt` сгенерирован
- [ ] `pip install -e .` выполняется без ошибок

---

### T1.1.3 — Create core config

**Описание:** Создать `core/config.py` с Pydantic Settings для конфигурации.

**Файл:** `backend/src/core/config.py`

**Переменные окружения:**
- `DATABASE_URL` — PostgreSQL connection string
- `TELEGRAM_BOT_TOKEN` — токен бота
- `ROBOKASSA_MERCHANT_LOGIN` — логин Robokassa
- `ROBOKASSA_PASSWORD_1` — пароль для генерации URL
- `ROBOKASSA_PASSWORD_2` — пароль для webhook
- `ROBOKASSA_IS_TEST` — тестовый режим (default: true)
- `WEBHOOK_BASE_URL` — базовый URL для callbacks

**DoD:**
- [ ] Settings class создан с Pydantic BaseSettings
- [ ] Все переменные типизированы
- [ ] Валидация на обязательные поля
- [ ] `.env.example` файл создан

---

### T1.1.4 — Create base exceptions

**Описание:** Создать `core/exceptions.py` с базовыми исключениями проекта.

**Файл:** `backend/src/core/exceptions.py`

**Исключения:**
- `AppException` — базовое исключение
- `NotFoundError` — ресурс не найден
- `ValidationError` — ошибка валидации
- `PaymentError` — ошибка платежа
- `InsufficientBalanceError` — недостаточно токенов
- `DuplicateError` — дубликат (для idempotency)

**DoD:**
- [ ] Все классы исключений созданы
- [ ] Исключения наследуются от базового
- [ ] Добавлены поля для error_code и message
